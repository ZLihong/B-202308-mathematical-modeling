clear;
clc;
x = [0.05 0.1 0.5 1 2 3 4 5];


%%红色着色剂的浓度
y = [0.636966 	0.253244 	0.132464 	0.180716 	0.253319 	0.345812 	0.452369 	0.437986 	0.477637 	0.073513 	0.013896 	0.010140 	0.007160 	0.005464 	0.006609 	0.006260; 
0.704712 	0.249816 	0.127612 	0.193364 	0.288492 	0.410812 	0.557369 	0.552986 	0.587637 	0.108513 	0.024396 	0.012490 	0.007460 	0.005514 	0.006509 	0.006110; 
0.905694 	0.682399 	0.548795 	0.524546 	0.799875 	1.160812 	1.627369 	1.702986 	1.697637 	0.618513 	0.131396 	0.035090 	0.012160 	0.007734 	0.007529 	0.006730; 
1.451922 	0.904127 	0.756273 	0.779024 	1.279604 	1.938812 	2.805369 	2.980986 	2.925637 	1.096513 	0.249196 	0.057390 	0.015460 	0.009914 	0.008209 	0.006910; 
2.204378 	1.899583 	1.723229 	1.563980 	2.515061 	3.770812 	5.437369 	5.812986 	5.657637 	2.318513 	0.531396 	0.112590 	0.026860 	0.015314 	0.010609 	0.008310; 
2.956834 	2.191039 	1.986185 	1.996936 	3.398518 	5.250812 	7.717369 	8.292986 	8.037637 	3.228513 	0.661396 	0.157590 	0.036160 	0.019714 	0.012009 	0.008710; 
3.409290 	2.902495 	2.669141 	2.639892 	4.491975 	6.940812 	10.207369 	10.982986 	10.627637 	4.328513 	0.951396 	0.207590 	0.045660 	0.024914 	0.013509 	0.009210; 
4.161746 	3.593951 	3.332097 	3.272848 	5.575432 	8.620812 	12.687369 	13.662986 	13.207637 	5.398513 	1.181396 	0.255590 	0.054660 	0.029814 	0.014509 	0.009210; 
];

%%黄色着色剂的浓度
% y = [0.558690 	0.574003 	0.574365 	0.498734 	0.382230 	0.246293 	0.124330 	0.054978 	0.026624 	0.010190 	0.004972 	0.002546 	0.002065 	0.001803 	0.001702 	0.001465; 
% 0.637690 	0.658003 	0.668365 	0.583234 	0.446230 	0.287793 	0.143330 	0.061478 	0.028624 	0.014340 	0.005302 	0.002636 	0.002104 	0.001822 	0.001711 	0.001470; 
% 1.268690 	1.329003 	1.419365 	1.258234 	0.957230 	0.618793 	0.294330 	0.120478 	0.052394 	0.021317 	0.008090 	0.003504 	0.002502 	0.002061 	0.001869 	0.001609; 
% 2.089790 	2.200103 	2.390465 	2.134334 	1.628330 	1.064893 	0.515430 	0.198888 	0.084734 	0.030051 	0.011643 	0.004657 	0.003036 	0.002394 	0.002103 	0.001799; 
% 3.677690 	3.888003 	4.278365 	3.832234 	2.916230 	1.902793 	0.903330 	0.346478 	0.142624 	0.060840 	0.018522 	0.006736 	0.003991 	0.002949 	0.002458 	0.002085; 
% 5.268690 	5.579003 	6.169365 	5.533234 	4.207230 	2.743793 	1.294330 	0.496478 	0.202624 	0.077840 	0.025522 	0.008936 	0.004981 	0.003539 	0.002848 	0.002404; 
% 6.931890 	7.342203 	8.132565 	7.306434 	5.570430 	3.626993 	1.727530 	0.649798 	0.265944 	0.119172 	0.032854 	0.011468 	0.006038 	0.004196 	0.003305 	0.002791; 
% 8.371690 	8.882003 	9.872365 	8.856234 	6.710230 	4.366793 	2.017330 	0.788778 	0.314924 	0.123070 	0.038752 	0.013379 	0.006958 	0.004716 	0.003625 	0.003041; 
% ];

%%蓝色着色剂的浓度
% y = [0.038287 	0.026632 	0.024242 	0.026521 	0.030091 	0.038078 	0.049709 	0.067265 	0.089624 	0.116558 	0.133857 	0.141659 	0.130499 	0.082875 	0.034727 	0.014168; 
% 0.054947 	0.040892 	0.038002 	0.044281 	0.049351 	0.065338 	0.083969 	0.111525 	0.153884 	0.194158 	0.221457 	0.234259 	0.219099 	0.147135 	0.058987 	0.030928; 
% 0.220853 	0.175632 	0.168742 	0.207021 	0.224091 	0.324078 	0.398709 	0.506265 	0.708624 	0.925558 	1.032857 	1.085659 	1.038499 	0.701875 	0.273727 	0.185668; 
% 0.427247 	0.302592 	0.290702 	0.368981 	0.401051 	0.561038 	0.705669 	0.831865 	1.234224 	1.627558 	1.834857 	1.937659 	1.850499 	1.227475 	0.500687 	0.337628; 
% 0.800687 	0.625632 	0.603742 	0.762021 	0.824091 	1.154078 	1.438709 	1.866265 	2.668624 	3.575558 	3.982857 	4.185659 	4.018499 	2.661875 	1.023727 	0.710668; 
% 1.317947 	0.898232 	0.866342 	1.104621 	1.196691 	1.676678 	2.101309 	2.708865 	3.911224 	5.118158 	5.725457 	6.028259 	5.781099 	3.904475 	1.496327 	1.033268; 
% 1.517847 	1.197232 	1.155342 	1.473621 	1.595691 	2.205678 	2.770309 	3.557865 	5.160224 	6.727558 	7.534857 	7.887659 	7.610499 	5.153475 	1.995327 	1.382268; 
% 1.816047 	1.469232 	1.417342 	1.815621 	1.967691 	2.686078 	3.390709 	4.398265 	6.400624 	8.387558 	9.394857 	9.897659 	9.490499 	6.393875 	2.467327 	1.704268; 
% ];

r2 = zeros(1,16);
rse = zeros(1,16);
pone = zeros(1,16);
ptwo = zeros(1,16);
for i = 1:16
[xData, yData] = prepareCurveData( x, y(:,i) );

%%函数和参数设置
ft = fittype( 'poly1' );
%%输出数据
[fitresult, gof] = fit( xData, yData, ft );
r2(i) = gof.rsquare;
rse(i) = gof.rmse;
pone(i) = fitresult.p1;
ptwo(i) = fitresult.p2;
Plot fit with data.
figure( 'Name', 'untitled fit 1' );
h = plot( fitresult, xData, yData );
legend( h, '真实值', '预测值', 'Location', 'NorthEast', 'Interpreter', 'none' );
xlabel( '浓度', 'Interpreter', 'none' );
ylabel( 'K/S', 'Interpreter', 'none' );
s = 400+(i-1)*20;
title([num2str(s) 'nm蓝色时K/S与浓度的关系'])
grid on
end

